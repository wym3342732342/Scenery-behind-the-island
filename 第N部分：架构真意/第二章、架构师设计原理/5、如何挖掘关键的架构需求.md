&emsp;&emsp;关键架构需求：`ASR`是显著影响架构选择的需求。架构师有责任确定对架构有重大影响的需求。

**`ASR`分为四类：**
- **约束：**给定或者说选定的不可更改的设计策略；
- **质量属性：**外部可见特性，表征系统在特定环境下的运行情况；
- **影响较大的功能需求：**架构设计需要特别注意的特性和功能；
- **其他影响因素：**时间、知识、经验、技术、办公室政治、你的技术特长，以及其他影响决策的东西；

## 1、用约束限制设计选择
&emsp;&emsp;约束比较好理解，适当的约束可以简化问题，过度的约束就会增加设计难度。其会对*人员、流程、成本*造成影响。

约束示例：

| 技术约束                              | 业务约束                                         |
| ------------------------------------- | ------------------------------------------------ |
| 编程语言（必须能在Java虚拟机上运行）  | 团队组成与结构（x小组开发Z组件）                 |
| 操作系统或平台（Windows、Linux、Beo） | 进度与预算（必须在展会前完工，成本低于80万美金） |
| 组件 和技术（数据库只能用DB2）        | 法律限制（授权许可限制，每天只有5GB）            |


> &emsp;&emsp;约束一旦确定就不能在继续讨价还价了。**慎重接受约束**。
> &emsp;&emsp;还有一点也很重要，随着系统逐渐成型，设计决策会变的越来越想约束，时刻记住那个是约束哪个是决策。尽可能不要让自己的决策变成枷锁。
> 

## 2、定义质量属性
&emsp;&emsp;质量属性描述了软件系统外部可见特性已经我们对系统的运行期望。**也被称之为质量需求**。

| 设计属性           | 运行属性 | 感知属性 |
| ------------------ | -------- | -------- |
| 可修改性           | 可用性   | 可管理性 |
| 可维护性           | 可靠性   | 可支持性 |
| 可复用性           | 性能     | 简单性   |
| 可测试性           | 可伸缩性 | 指导性   |
| 可构建性或开发时间 | 安全性   |          |


&emsp;&emsp;**每个架构设计决策都至少会提升或抑制一个质量属性**。大多数的设计决策都是在提升某些质量属性的同时抑制了其他的质量属性。

> &emsp;&emsp;质量属性属于非功能性需求，功能需求描述系统行为，非功能性需求描述功能需求之外的其他系统需求，包括质量属性和约束。
> &emsp;&emsp;设计软件架构必须区分功能、约束、质量属性，因为每种需求背后有不同的驱动力。例如：约束没有谈判余地，而质量属性可以取舍，
> &emsp;&emsp;但是说质量属性是非功能性需求又很奇怪，因为软件的响应是某个功能的直接结果但是这个结果也包含了质量属性。因为质量属性只有在系统运行时才具有意义。那么我们应该清晰的把质量属性提取出来。
> 

### 2.1 用场景描述质量属性 
&emsp;&emsp;质量属性听起来很抽象（可扩展性、可用性、性能等）。应该给他们更具体的含义。质量属性场景与功能需求的不同之处在于，系统除了能够正确响应，如何响应也很重要。

*质量属性场景的六个元素：*

![image-20220430102130106](https://gitee.com/tizo_kingbb/picImg/raw/master/img/20220430102135.png)

- **刺激：**刺激启动了一个场景。相当于一个需求，它需要系统以某种方式响应事件。
- **来源：**刺激的来源。可能是人、系统，比如用户、系统组件、外部系统。
- **软件部分：**系统的某个部分。也可以是整个系统的特定组件。
- **响应：**外部可见的活动。受到刺激后引发的响应。
- **响应度量：**定义响应成功的标准和条件。响应度量必须是具体、明确、可衡量的。
- **环境背景：**描述了场景中系统的操作环境。一般要明确说明（如：一切正常、满负载、故障情况）

### 2.2 寻找具体的可衡量响应度量
&emsp;&emsp;良好的响应度量是可测试的，前期的架构是在纸面上的，但是可运行的系统迟早会出现，如果你不知道如何对场景进行测试，那么这个场景实际上就缺少具体、可衡量的响应度量。


## 3、对功能需求分类
&emsp;&emsp;功能需求通常以用例或用户故事的形式记录，如果**某个功能需求影响架构决策**，将其称为**影响较大的功能需求。**

&emsp;&emsp;这类需求往往是架构杀手，那么如何确定一个影响较大的功能需求呢？这需要方法、技巧、经验。参考做法：
1. 先画出概念架构草图，展示你当前对架构的构想。
2. 对功能嗯那个需求进行大致分类，每类需求反映一个相同类型的架构问题。
3. 对照概念架构草图，思考每个分类如何实现。如果对于已知的粗粒度需求，实现功能的方式并不明显，那么它就可能对架构有重大影响。

**将大量的功能需求归入少数有代表性的类型：**
- 寻找可以使用相同架构元素实现的功能需求。例如：需要持续运行的功能可以归为一类，而需要用户交互的功能可以归为另一类。
- 寻找看起来有难度的功能需求，它们对架构可能有重大影响。
- 寻找重要的，高优先级的功能需求。


## 4、找出其他影响架构的因素

![image-20220430104953758](https://gitee.com/tizo_kingbb/picImg/raw/master/img/20220430104953.png)

&emsp;&emsp;架构师的能力和经验决定了如何开展架构设计，以及有哪些备选项。架构师和团队对技术的掌握程度决定了你们的设计方式。**如果你的手里只有锤子，那么你看什么都像钉子。**

> &emsp;&emsp;架构设计往往都是在追求热门技术。新硬件、新软件、新设计范式不断涌现，有些对软件开发产生了深远的影响。有些不过是“旧瓶装新酒”。你的架构很可能就采用了最流行的设计，如同最时髦的发型。
> 


### 4.1 接受康威定律
&emsp;&emsp;团队的组织结构与合作形式会影响架构设计。

> &emsp;&emsp;任何设计系统的组织……产生的设计必然是该组织沟通结构的写照。架构中各种元素的边界正是人们沟通边界的投影。
> 

##5、挖掘关键架构需求
&emsp;&emsp;关键架构需求往往是隐藏着的，需要挖掘，一般**业务经理含蓄的描述中**或是**利益相关方的提示里**都可能藏着关键架构需求。这些人知道自己想要什么，只是不清楚如何表达出来。

&emsp;&emsp;**产品待办列表（backlog）**，是挖掘关键架构需求的宝藏，有时用户故事会清楚地描述响应时间、可伸缩性需求，以及处理故障的方式。**将这些质量属性场景记录下来，以免它们在功能待办列表中丢失。**

&emsp;&emsp;与利益相关方沟通，询问他们担心什么，了解他们关心的问题。告诉他们有哪些存在的风险，哪些可能会出现的问题。下面列举了一些用于挖掘关键架构需求的方法：

- GQM研讨会：将业务目标、质量属性响应度量与具体数据要求联系起来。
- 利益相关方访谈：搞清楚质量属性场景和约束，这对技术利益相关方一尤其有效。
- 假设清单：将隐藏需求明晰化、公开化。
- 微型质量属性研讨会：快速有效地定义高优先级的质量属性场景，这对任何类型的项目，以及有不同技能和背景的利益相关方都奏效。
- 启动计划书：启动一个新项目时，将启动计划书作为检查清单，架构设计拾柒中的主要内容。

##6、创建ASR工作簿
&emsp;&emsp;发现关键架构需求（ASR）之后，应该有响应的记录（ASR工作簿），刚刚启动新项目时，ASR工作簿是一个需要频繁修改的文档。等架构稳定下来后，你就不会再频繁地修改它了，但是会**频繁的参考它**。再往后可执行的测试和源代码可能会取代ASR工作簿的部分作用。不过该文档仍是重要的历史记录。

&emsp;&emsp;ASR工作簿为程序员、测试人员，还有架构师提供系统背景信息，了解关键架构需求的人越多，所需的架构设计监督就越少。

&emsp;&emsp;常用的ASR工作簿大纲，在收集需求的计划时，可以将此大纲作为检查清单。
```shell
	目的与范围
	阅读对象
	业务背景
		利益相关方
		业务目标
	关键架构需求
		技术约束
		业务约束
		数量属性需求
			重点场景
		有影响力的功能需求
			重点用户或用户角色
			用例或用户故事
	附录A：术语表
	附录B：质量属性分类
```

> &emsp;&emsp;**做一个积极的倾听者**
> &emsp;&emsp;了解利益相关方及其目标是通过软件实现价值的第一步，将需求转化为可实施的想法。想要让开发人员和管理人员理解你的愿景并转化为代码，还需要出色的**沟通技巧**。
> 

